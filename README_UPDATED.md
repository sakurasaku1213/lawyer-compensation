# 弁護士基準損害賠償計算システム v2.0

## 🎯 システム概要

**プロフェッショナルグレード**の法律事務所向け損害賠償計算システムです。弁護士基準（赤い本基準）に基づく正確な計算、現代的なUI、包括的なデータ管理機能を提供します。

### ✨ 主な改善点（v2.0）
- **統合設定管理システム** - 一元化された設定とカスタマイズ
- **リアルタイム監視** - パフォーマンス・エラー・セキュリティの総合監視
- **堅牢なデータベース** - トランザクション対応・バックアップ機能
- **セキュリティ強化** - データ暗号化・アクセス制御・監査ログ
- **自動化システム** - 依存関係管理・ビルド・テスト・デプロイ
- **プロフェッショナルUI** - CustomTkinter による現代的デザイン
- **法定利息計算と詳細PDFレポート** - 法定利息計算機能の追加と、計算根拠を示す詳細な表を含むPDFレポートオプションの提供。

## 🚀 クイックスタート

### 1. システム起動
```bash
# 通常起動（推奨）
python main.py

# 自動セットアップ付き起動
python main.py --auto-install

# 開発者モード
python main.py --dev-mode
```

### 2. 初回セットアップ
システムが自動的に以下を実行します：
- ✅ 依存関係の確認・インストール
- ⚙️ 設定ファイルの初期化
- 🔒 セキュリティシステムの起動
- 📊 監視システムの開始

## 🏗️ システム構成

### コアコンポーネント
```
compensation-system/
├── main.py                    # メインエントリーポイント
├── config/                    # 統合設定管理
│   ├── app_config.py         # 設定管理システム
│   └── app_config.json       # デフォルト設定
├── ui/                       # ユーザーインターフェース
│   ├── modern_calculator_ui.py
│   └── components/           # UI コンポーネント
├── calculation/              # 計算エンジン
│   ├── compensation_engine.py
│   ├── interest.py           # 法定利息計算ロジック
│   └── standards/            # 基準値定義
├── database/                 # データベース管理
│   └── db_manager.py         # 統合データベースシステム
├── models/                   # データモデル
│   └── case_data.py          # 案件データ構造
├── reports/                  # レポート生成
│   ├── excel_generator.py    # Excel出力エンジン
│   └── pdf_generator.py     # PDF出力エンジン
├── utils/                    # ユーティリティ
│   ├── error_handler.py      # エラーハンドリング
│   ├── performance_monitor.py # パフォーマンス監視
│   └── security_manager.py   # セキュリティ管理
├── tests/                    # テストスイート
│   ├── unit/                 # ユニットテスト
│   └── integration/          # 統合テスト
└── build_system.py           # 統合ビルドシステム
```

### 新機能システム
- **🔧 統合設定管理** - 全てのコンポーネントの設定を一元管理
- **⚠️ エラーハンドリング** - 統一されたエラー処理と復旧機能
- **📈 パフォーマンス監視** - リアルタイム性能監視と最適化提案
- **🛡️ セキュリティシステム** - データ暗号化・アクセス制御・監査ログ
- **🔧 依存関係管理** - 自動インストール・アップデート管理
- **🧪 包括的テスト** - ユニット・統合・パフォーマンステスト

## 💼 機能詳細

### 1. 💰 損害計算エンジン

#### 入通院慰謝料
- 弁護士基準（赤い本）別表I/II に基づく計算
- 入院期間、通院期間の入力
- むちうち症等（他覚所見なし）の場合の別表II適用
- 実通院日数の考慮

#### 後遺障害慰謝料
- 後遺障害等級（1級〜14級）に応じた弁護士基準慰謝料
- 等級別の標準的な慰謝料額を自動計算
- 労働能力喪失率の自動設定

#### 休業損害
- 休業日数と日額基礎収入による計算
- 職業別の基礎収入認定支援

#### 後遺障害逸失利益
- 基礎年収 × 労働能力喪失率 × ライプニッツ係数
- 症状固定時年齢から67歳までの就労可能年数計算
- 中間利息控除（ライプニッツ係数）の自動適用

#### 法定利息
- 適用される法定利率（2020年4月1日施行の改正民法前後）に基づいた遅延損害金等の利息計算。
- 主な入力項目：元本金額、利息計算の開始日と終了日。
- 単純計算方式（単利）を採用。
- 2020年4月1日以降は変動利率制（当初3%、3年ごとに見直し）に対応。

### 3. 結果出力機能
- 計算結果の詳細表示（項目別内訳と合計額）
- 計算根拠の明示
- テキストファイル保存機能
- PDF出力機能（報告書形式）改善：計算根拠を示す詳細な内訳表（特に法定利息計算の詳細など）を含むオプションを追加。

### 4. ユーザビリティ機能
- タブ形式による操作の整理
- 入力ミス防止のバリデーション
- 分かりやすいエラーメッセージ
- データクリア機能

## インストールと使用方法

### 必要な環境
- Windows 10/11
- Python 3.7以上

### 必要なライブラリのインストール
```bash
pip install reportlab
```

### 使用方法
1. `lawyer_compensation_calculator.py` を実行
2. 「基本情報」タブから案件の基本データを入力
3. 各損害項目のタブで詳細情報を入力
4. 「計算実行」ボタンで計算を実行
5. 「計算結果」タブで結果を確認
6. 必要に応じて「結果を保存」または「PDF出力」

## 弁護士基準データについて

### 入通院慰謝料基準
- 民事交通事故訴訟 損害賠償額算定基準（赤い本）に基づく
- 別表I（通常の傷害）と別表II（むちうち症等）を区別
- 入院期間と通院期間の組み合わせによる金額設定

### 後遺障害慰謝料基準
- 弁護士基準による等級別慰謝料額
- 自賠責基準・任意保険基準よりも高額な設定

### 労働能力喪失率
- 後遺障害等級に応じた標準的な喪失率
- 個別事情による調整は弁護士による検討が必要

### ライプニッツ係数
- 法定利率3%に基づく中間利息控除係数
- 就労可能年数に応じた係数の自動適用

## 注意事項

### 計算の限界
- 本システムは標準的な弁護士基準による機械的計算のみ
- 個別事情による増減額は考慮されない
- 最終的な賠償額の決定には弁護士による専門的検討が必要

### データの更新
- 赤い本の改訂時にはマスターデータの更新が必要
- 法定利率変更時にはライプニッツ係数の見直しが必要
- 法定利率は2020年4月1日より変動制が導入され、以後3年ごとに見直されます。計算時には適切な利率が適用されているか確認が必要です。

### セキュリティ
- 案件データの取り扱いには十分注意
- 機密情報の漏洩防止対策の実施

## カスタマイズ可能な項目

### 基準データの調整
- 慰謝料基準額の変更
- ライプニッツ係数の更新
- 労働能力喪失率の調整

### 出力形式の変更
- 計算書のレイアウト調整
- 事務所独自の書式への対応
- 追加項目の設定

### 機能拡張
- 物損計算機能の追加
- 案件データベース機能
- 複数ケースの比較機能

## サポート
- 操作方法についてのご質問
- カスタマイズのご相談
- バグ報告・改善提案

本システムが法律事務所の業務効率化にお役立ていただければ幸いです。
